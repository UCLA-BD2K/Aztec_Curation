<html>
  <head>
    <title>Test Edit</title>
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
  </head>

  <body>
    <h1>Test Edit</h1>
	<span id='message'><%= message %></span>
	<span id='form'></span>
	<script>
	console.log(message);

  function isObject(element) {
    return (typeof element === "object") && (element !== null);
  };
  function createForm(form, json){
    for (var prop in json) {
      if(prop.startsWith('_'))
        continue;
        
  		var isID = prop == "AZID";
      var isArr = Array.isArray(json[prop]);
      var isObj = isObject(json[prop]);
  		var row = document.createElement("div");

  		var foreText = document.createElement("div");
  		foreText.innerHTML = "<br><b>"+prop+":</b> ";

      if(isArr || isObj){
        row.appendChild(foreText);
        form.appendChild(row);
        form = createForm(form, json[prop]);
        continue;
      }

  		var field = document.createElement("input");
  		field.type = "text";
  		field.name = prop;
  		field.id = prop;
  		field.value = json[prop];
  		if(isID)
  			field.readOnly = true;

  		var afterText = document.createElement("div");
  		afterText.innerHTML = "";

  		row.appendChild(foreText);
  		row.appendChild(field);
  		row.appendChild(afterText);

  		form.appendChild(row);
    }
    return form;
  }
	var jsonObject = JSON.parse(document.getElementById('message').innerHTML);
	var formPlace = document.getElementById('form');
	//var form = "<br><br><form action=\"\" method=\"POST\">";

	var form = document.createElement("form");
	form.action = "";
	form.method = "POST";

  form = createForm(form, jsonObject);

	var submitButton = document.createElement("button");
	submitButton.type = "submit";
	submitButton.appendChild(document.createTextNode("Submit"));

	form.appendChild(submitButton);
	//form += "<br><br><input type=\"submit\" value=\"Submit\">";
	//form += "</form>";

	//console.log(form);
	formPlace.appendChild(form);// = form;
	</script>

  </body>
</html>
